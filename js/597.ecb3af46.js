"use strict";(self["webpackChunkvue_w6"]=self["webpackChunkvue_w6"]||[]).push([[597],{530:function(e,t,a){function l(e){return{all:e=e||new Map,on:function(t,a){var l=e.get(t);l?l.push(a):e.set(t,[a])},off:function(t,a){var l=e.get(t);l&&(a?l.splice(l.indexOf(a)>>>0,1):e.set(t,[]))},emit:function(t,a){var l=e.get(t);l&&l.slice().map((function(e){e(a)})),(l=e.get("*"))&&l.slice().map((function(e){e(t,a)}))}}}a.d(t,{Z:function(){return o}});const s=l();var o=s},597:function(e,t,a){a.r(t),a.d(t,{default:function(){return j}});var l=a(252),s=a(577),o=a(963);const r={class:"container"},n=(0,l._)("h1",{class:"mt-4"},"購物車",-1),i={class:"table mt-4"},d=(0,l._)("thead",null,[(0,l._)("tr",null,[(0,l._)("td"),(0,l._)("td",null,"品名"),(0,l._)("td",{class:"text-center",width:"20%"},"數量/單位"),(0,l._)("td",{class:"text-end"},"單價")])],-1),c=["onClick"],u={class:"text-center"},m=["for"],p=["id","onUpdate:modelValue","onChange","disabled"],f={class:"input-group-text"},h={class:"text-end"},_={class:"text-end"},b=(0,l._)("td",{colspan:"3"},"總計",-1),g={class:"text-end"},v={class:"row justify-content-center"},y={class:"mb-3"},C=(0,l._)("label",{for:"email",class:"form-label"},"Email",-1),w={class:"mb-3"},x=(0,l._)("label",{for:"姓名",class:"form-label"},"收件人姓名",-1),V={class:"mb-3"},k=(0,l._)("label",{for:"電話",class:"form-label"},"收件人電話",-1),W={class:"mb-3"},q=(0,l._)("label",{for:"地址",class:"form-label"},"收件人地址",-1),D={class:"mb-3"},I=(0,l._)("label",{for:"message",class:"form-label"},"留言",-1),$={class:"text-end"},U=["disabled"];function z(e,t,a,z,L,O){const Z=(0,l.up)("v-field"),A=(0,l.up)("error-message"),j=(0,l.up)("v-form");return(0,l.wg)(),(0,l.iD)("div",r,[n,(0,l._)("table",i,[d,(0,l._)("tbody",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(L.cartData.carts,(e=>((0,l.wg)(),(0,l.iD)("tr",{key:e.id},[(0,l._)("td",null,[(0,l._)("button",{type:"button",class:"btn btn-outline-danger",onClick:t=>O.deleteCartItem(e.id)}," x ",8,c)]),(0,l._)("td",null,(0,s.zw)(e.product.title),1),(0,l._)("td",u,[(0,l._)("label",{for:e.id,class:"input-group input-group-sm"},[(0,l.wy)((0,l._)("input",{id:e.id,type:"number",class:"form-control",min:"1","onUpdate:modelValue":t=>e.qty=t,onChange:t=>O.updateCartItem(e),disabled:L.isLoadingItem===e.id},null,40,p),[[o.nr,e.qty]]),(0,l._)("span",f,(0,s.zw)(e.product.unit),1)],8,m)]),(0,l._)("td",h,(0,s.zw)(e.product.price)+" 元",1)])))),128))]),(0,l._)("tfoot",null,[(0,l._)("tr",_,[b,(0,l._)("td",null,(0,s.zw)(L.cartData.final_total)+" 元",1)])])]),(0,l._)("div",g,[(0,l._)("button",{type:"button",class:"btn btn-outline-danger",onClick:t[0]||(t[0]=(...e)=>O.deleteAllCart&&O.deleteAllCart(...e))}," 清空購物車 ")]),(0,l._)("div",v,[(0,l.Wm)(j,{class:"col-10",onSubmit:O.createOrder,ref:"form"},{default:(0,l.w5)((({errors:e})=>[(0,l._)("div",y,[C,(0,l.Wm)(Z,{type:"email",name:"email",class:(0,s.C_)(["form-control",{"is-invalid":e["email"]}]),id:"email",placeholder:"請輸入Email",rules:"email|required",modelValue:L.form.user.email,"onUpdate:modelValue":t[1]||(t[1]=e=>L.form.user.email=e)},null,8,["class","modelValue"]),(0,l.Wm)(A,{name:"email",class:"invalid-feedback"})]),(0,l._)("div",w,[x,(0,l.Wm)(Z,{type:"name",name:"姓名",class:(0,s.C_)(["form-control",{"is-invalid":e["姓名"]}]),id:"姓名",placeholder:"請輸入收件人姓名",rules:"required",modelValue:L.form.user.name,"onUpdate:modelValue":t[2]||(t[2]=e=>L.form.user.name=e)},null,8,["class","modelValue"]),(0,l.Wm)(A,{name:"姓名",class:"invalid-feedback"})]),(0,l._)("div",V,[k,(0,l.Wm)(Z,{type:"tel",name:"電話",class:(0,s.C_)(["form-control",{"is-invalid":e["電話"]}]),id:"電話",placeholder:"請輸入收件人電話",rules:"required|min:9|max:10",modelValue:L.form.user.tel,"onUpdate:modelValue":t[3]||(t[3]=e=>L.form.user.tel=e)},null,8,["class","modelValue"]),(0,l.Wm)(A,{name:"電話",class:"invalid-feedback"})]),(0,l._)("div",W,[q,(0,l.Wm)(Z,{type:"text",name:"地址",class:(0,s.C_)(["form-control",{"is-invalid":e["地址"]}]),id:"地址",placeholder:"請輸入收件人地址",rules:"required",modelValue:L.form.user.address,"onUpdate:modelValue":t[4]||(t[4]=e=>L.form.user.address=e)},null,8,["class","modelValue"]),(0,l.Wm)(A,{name:"地址",class:"invalid-feedback"})]),(0,l._)("div",D,[I,(0,l.wy)((0,l._)("textarea",{class:"form-control",id:"message",rows:"3","onUpdate:modelValue":t[5]||(t[5]=e=>L.form.message=e)},null,512),[[o.nr,L.form.message]])]),(0,l._)("div",$,[(0,l._)("button",{type:"submit",class:"btn btn-primary",disabled:Object.keys(e).length>0||0===L.cartData.carts.length}," 送出 ",8,U)])])),_:1},8,["onSubmit"])])])}var L=a(530),O={data(){return{cartData:{carts:[]},isLoadingItem:"",form:{user:{email:"",name:"",tel:"",address:""},message:""}}},methods:{getCart(){const e="https://vue3-course-api.hexschool.io/v2/api/yunei/cart";this.$http.get(e).then((e=>{this.cartData=e.data.data})).catch((e=>{console.log(e.data)}))},updateCartItem(e){const t=`https://vue3-course-api.hexschool.io/v2/api/yunei/cart/${e.id}`,a={data:{product_id:e.product_id,qty:e.qty}};this.isLoadingItem=e.id,this.$http.put(t,a).then((()=>{this.isLoadingItem="",this.getCart()})).catch((e=>{console.log(e.response.data)}))},deleteCartItem(e){const t=`https://vue3-course-api.hexschool.io/v2/api/yunei/cart/${e}`;this.$http.delete(t).then((()=>{this.getCart(),L.Z.emit("get-cart")})).catch((e=>{console.log(e.response.data)}))},deleteAllCart(){const e="https://vue3-course-api.hexschool.io/v2/api/yunei/carts";this.$http.delete(e).then((()=>{this.getCart(),L.Z.emit("get-cart")})).catch((e=>{alert(e.response.data.message)}))},createOrder(){console.log("send");const e="https://vue3-course-api.hexschool.io/v2/api/yunei/order",t={data:this.form};this.$http.post(e,t).then((e=>{alert(e.data.message),this.$refs.form.resetForm(),this.form.message="",this.getCart()})).catch((e=>{console.log(e.data)}))}},mounted(){this.getCart()}},Z=a(744);const A=(0,Z.Z)(O,[["render",z]]);var j=A}}]);
//# sourceMappingURL=597.ecb3af46.js.map